//
//  DeviceDetector.swift
//  Local Scope
//

import Foundation

struct DeviceDetector {
    
    static func detectType(mac: String, ip: String) -> String {
        let macPrefix = mac.prefix(8).lowercased()
        
        if ip.hasSuffix(".1") || ip.hasSuffix(".254") {
            return "üåê Router"
        }
        
        if macPrefix.hasPrefix("00:50:56") || macPrefix.hasPrefix("00:0c:29") {
            return "üíª VMware Virtual Machine"
        }
        
        if macPrefix.hasPrefix("08:00:27") {
            return "üíª VirtualBox VM"
        }
        
        let appleMACs = ["00:03:93", "00:05:02", "00:0a:27", "00:0a:95", "00:0d:93",
                        "00:11:24", "00:14:51", "00:16:cb", "00:17:f2", "00:19:e3",
                        "00:1b:63", "00:1c:b3", "00:1e:52", "00:1e:c2", "00:1f:5b",
                        "00:1f:f3", "00:21:e9", "00:22:41", "00:23:12", "00:23:32",
                        "00:23:6c", "00:23:df", "00:24:36", "00:25:00", "00:25:4b",
                        "00:25:bc", "00:26:08", "00:26:4a", "00:26:b0", "00:26:bb",
                        "04:0c:ce", "04:15:52", "04:26:65", "04:d3:cf", "04:f1:3e",
                        "04:f7:e4", "08:66:98", "08:70:45", "0c:3e:9f", "0c:74:c2",
                        "10:93:e9", "10:9a:dd", "10:dd:b1", "14:10:9f", "14:5a:05",
                        "14:8f:c6", "14:bd:61", "18:34:51", "18:3d:a2", "18:e7:f4",
                        "1c:1a:c0", "1c:36:bb", "1c:ab:a7", "20:78:f0", "20:a2:e4",
                        "20:ab:37", "20:c9:d0", "24:24:0e", "24:5b:a7", "24:a0:74",
                        "24:ab:81", "24:f0:94", "24:f6:77", "28:37:37", "28:5a:eb",
                        "28:6a:b8", "28:a0:2b", "28:cf:da", "28:e1:4c", "28:e7:cf",
                        "2c:0e:3d", "2c:1f:23", "2c:33:11", "2c:36:f8", "2c:be:08",
                        "2c:f0:a2", "2c:f0:ee", "30:10:b3", "30:35:ad", "30:90:ab",
                        "30:d9:d9", "30:f7:c5", "34:12:f9", "34:15:9e", "34:36:3b",
                        "34:51:c9", "34:a3:95", "34:c0:59", "34:e2:fd", "38:0f:4a",
                        "38:48:4c", "3c:07:54", "3c:15:c2", "3c:2e:f9", "40:30:04",
                        "40:33:1a", "40:3c:fc", "40:4d:7f", "40:6c:8f", "40:a6:d9",
                        "40:b3:95", "40:cb:c0", "44:2a:60", "44:4c:0c", "44:d8:84",
                        "48:3b:38", "48:43:7c", "48:60:bc", "48:74:6e", "48:a1:95",
                        "48:d7:05", "4c:57:ca", "4c:74:bf", "4c:7c:5f", "4c:8d:79",
                        "50:32:37", "50:ea:d6", "54:26:96", "54:33:cb", "54:72:4f",
                        "54:9f:13", "54:ae:27", "54:e4:3a", "58:1f:aa", "58:40:4e",
                        "58:55:ca", "58:b0:35", "5c:59:48", "5c:95:ae", "5c:96:9d",
                        "5c:f9:38", "60:03:08", "60:33:4b", "60:69:44", "60:92:17",
                        "60:c5:47", "60:f8:1d", "60:fa:cd", "60:fb:42", "64:20:0c",
                        "64:76:ba", "64:a3:cb", "64:b0:a6", "64:e6:82", "68:5b:35",
                        "68:9c:70", "68:a8:6d", "68:d9:3c", "68:fe:f7", "6c:19:c0",
                        "6c:3e:6d", "6c:40:08", "6c:70:9f", "6c:72:20", "6c:94:66",
                        "6c:96:cf", "6c:ab:31", "70:11:24", "70:56:81", "70:73:cb",
                        "70:cd:60", "70:de:e2", "70:ec:e4", "74:1b:b2", "74:e1:b6",
                        "74:e2:f5", "78:31:c1", "78:7b:8a", "78:a3:e4", "78:ca:39",
                        "78:d7:5f", "78:fd:94", "7c:01:91", "7c:11:be", "7c:50:49",
                        "7c:6d:f8", "7c:c3:a1", "7c:d1:c3", "7c:f0:5f", "80:19:34",
                        "80:49:71", "80:92:9f", "80:e6:50", "84:38:35", "84:78:8b",
                        "84:85:06", "84:89:ad", "84:fc:fe", "88:1f:a1", "88:53:95",
                        "88:63:df", "88:66:5a", "88:c6:63", "88:e8:7f", "8c:29:37",
                        "8c:58:77", "8c:7c:92", "8c:85:90", "8c:fa:ba", "90:27:e4",
                        "90:72:40", "90:84:0d", "90:b0:ed", "90:b2:1f", "94:0c:6d",
                        "94:e9:6a", "94:f6:a3", "98:01:a7", "98:03:d8", "98:5a:eb",
                        "98:b8:e3", "98:f0:ab", "98:fe:94", "9c:04:eb", "9c:20:7b",
                        "9c:35:5b", "9c:84:bf", "9c:fc:e8", "a0:18:28", "a0:99:9b",
                        "a0:d7:95", "a4:31:35", "a4:5e:60", "a4:67:06", "a4:83:e7",
                        "a4:b1:97", "a4:c3:61", "a8:20:66", "a8:5b:78", "a8:66:7f",
                        "a8:88:08", "a8:96:8a", "a8:be:27", "a8:fa:d8", "ac:1f:74",
                        "ac:29:3a", "ac:3c:0b", "ac:61:ea", "ac:87:a3", "ac:bc:32",
                        "ac:cf:5c", "ac:de:48", "ac:fd:ec", "b0:34:95", "b0:65:bd",
                        "b0:9f:ba", "b0:ca:68", "b4:18:d1", "b4:8b:19", "b4:f0:ab",
                        "b4:f6:1c", "b8:09:8a", "b8:17:c2", "b8:41:a4", "b8:44:d9",
                        "b8:53:ac", "b8:78:2e", "b8:8d:12", "b8:c7:5d", "b8:e8:56",
                        "b8:f6:b1", "bc:3b:af", "bc:52:b7", "bc:67:1c", "bc:6c:21",
                        "bc:92:6b", "bc:9f:ef", "bc:d0:74", "c0:1a:da", "c0:3f:0e",
                        "c0:63:94", "c0:84:7d", "c0:9a:d0", "c0:ce:cd", "c0:d0:12",
                        "c4:2c:03", "c4:b3:01", "c8:2a:14", "c8:33:4b", "c8:69:cd",
                        "c8:b5:b7", "c8:bc:c8", "c8:d0:83", "c8:e0:eb", "cc:08:8d",
                        "cc:25:ef", "cc:29:f5", "cc:2d:b7", "cc:44:63", "cc:78:5f",
                        "d0:03:4b", "d0:23:db", "d0:25:98", "d0:33:11", "d0:81:7a",
                        "d0:a6:37", "d0:c5:f3", "d0:d2:b0", "d0:e1:40", "d4:61:9d",
                        "d4:9a:20", "d4:dc:cd", "d4:f4:6f", "d8:00:4d", "d8:30:62",
                        "d8:96:95", "d8:9e:3f", "d8:a2:5e", "d8:bb:2c", "d8:cf:9c",
                        "dc:2b:2a", "dc:37:39", "dc:3e:51", "dc:86:d8", "dc:a9:04",
                        "dc:d3:a2", "dc:e4:cc", "e0:33:8e", "e0:66:78", "e0:ac:cb",
                        "e0:b5:2d", "e0:c7:67", "e0:f5:c6", "e0:f8:47", "e4:25:e7",
                        "e4:8b:7f", "e4:9a:79", "e4:c6:3d", "e4:ce:8f", "e8:04:62",
                        "e8:06:88", "e8:2a:ea", "e8:80:2e", "e8:8d:28", "ec:35:86",
                        "ec:85:2f", "f0:18:98", "f0:24:75", "f0:c1:f1", "f0:db:e2",
                        "f0:dc:e2", "f0:f6:1c", "f4:0f:24", "f4:1b:a1", "f4:31:c3",
                        "f4:37:b7", "f4:5c:89", "f4:f1:5a", "f4:f9:51", "f8:1e:df",
                        "f8:27:93", "f8:d0:ac", "fc:25:3f", "fc:e9:98", "fc:fc:48"]
        
        for prefix in appleMACs {
            if macPrefix.hasPrefix(prefix) {
                return "üì± Apple Device"
            }
        }
        
        if macPrefix.hasPrefix("b8:27:eb") || macPrefix.hasPrefix("dc:a6:32") {
            return "üçì Raspberry Pi"
        }
        
        return "üíª Network Device"
    }
}
